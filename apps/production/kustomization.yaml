apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  # Headless
  - ../base/headless
  - ./headless/sealed-secret.yaml
#   # Umami
#   - ../base/umami
#   # Remark42
#   - ../base/remark42
#   - ./remark42/sealed-secret.yaml
#   # Web
#   - ../base/web
#   - ./web/sealed-secret.yaml
#   # GitOps
#   - ../base/gitops
#   - ./gitops/image-policies.yaml
#   - ./gitops/fluxcd-signing-key.sealed-secret.yaml
#   - ./gitops/slack-url.sealed-secret.yaml
patches:
  # Headless
  - path: ./headless/patch.config-map.yaml
    target:
      kind: ConfigMap
      name: headless-env
  - path: ./headless/patch.depl.yaml
    target:
      kind: Deployment
      name: headless
  - path: ./headless/patch.http-route.yaml
    target:
      kind: HTTPRoute
      name: headless-http
  - path: ./headless/patch.https-route.yaml
    target:
      kind: HTTPRoute
      name: headless-https
  # # Umami
  # - path: ./umami/http-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: umami-http
  # - path: ./umami/https-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: umami-https
  # # Remark42
  # - path: ./remark42/http-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: remark42-http
  # - path: ./remark42/https-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: remark42-https
  # - path: ./remark42/depl.yaml
  #   target:
  #     kind: Deployment
  #     name: remark42
  # - path: ./remark42/config-map.yaml
  #   target:
  #     kind: ConfigMap
  #     name: remark42
  # # Web
  # - path: ./web/http-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: web-http
  # - path: ./web/https-route.yaml
  #   target:
  #     kind: HTTPRoute
  #     name: web-https
  # - path: ./web/depl.yaml
  #   target:
  #     kind: Deployment
  #     name: web
  # - path: ./web/config-map.yaml
  #   target:
  #     kind: ConfigMap
  #     name: web-env
  # # GitOps
  # - path: ./gitops/alert.patch.yaml
  #   target:
  #     kind: Alert
  #     name: slack
  # - path: ./gitops/image-update-automation.patch.yaml
  #   target:
  #     kind: ImageUpdateAutomation
  #     name: harrytang